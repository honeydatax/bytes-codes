' Gambas class file

Public Sub _new()

End

Public Sub Form_Open()

End

Public Sub Button1_Click()
Dim v As String
Dim i As Integer
Dim p As Process
Dim f1 As File
Dim f2 As File
f1 = Open "/home/pi/out" For Output Create
Print #f1, ""
Close #f1
v = TextBox1.Text
i = 0
i = InStr(v, ">")
If i < 1 Then i = InStr(v, "<")
If i > 0 Then
  p = Shell "/bin/sh  -c '" & v & "'"
  Else
  p = Shell "/bin/sh  -c '" & v & "' > /home/pi/out"
Endif
TextArea1.Text = v & Chr(13) & Chr(10) & TextArea1.Text 
Timer1.Start()
End Sub

Public Sub Timer1_Timer()
Dim f2 As File
Dim v As String
Timer1.Stop()
f2 = Open "/home/pi/out" For Input
While Not Eof(f2)
  Line Input #f2, v
  TextArea1.Text = v & Chr(13) & Chr(10) & TextArea1.Text
Wend
Close f2
Timer1.Stop()
Form.Refresh()
End
